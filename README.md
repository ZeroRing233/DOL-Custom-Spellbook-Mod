# 自定义魔法书（言灵集）模组
（尚未发布，只是先写下文档）
## 一句话简介

本模组是DOL游戏的言灵管理工具，推荐受众为**已使用过任一侧边栏言灵模组的玩家**，主要功能包括：将言灵按照言灵集分类，通过文件/文本框导入/导出言灵集，跨存档保存言灵集，在全部或指定言灵集中查找言灵，对本存档言灵集中的言灵进行排序/编辑/批量删除/加入侧边栏等操作，欢迎大家按需下载~

## 安装方式说明
本模组基于0.5.2.x版本进行自测，旧版本会存在不兼容的问题，请确保您手上的游戏是最新版本，然后下载release下的（文件名），并使用平时游玩汉化版时使用的mod管理器加载完汉化模组后，再加载此模组。

模组加载时会弹出密码界面，密码为本仓库的名称：**DOL-Custom-Spellbook-Mod**
（直接复制后输入即可）

<details>
  <summary><strong>点击查看图片 1.输入密码</strong></summary>

  ![输入密码](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/1-password.jpg)
</details>

加载成功后，魔法书将出现在游戏的侧边栏（收纳状态下），点击即可体验本模组~

<details>
  <summary>点击查看图片 2.魔法书位置</summary>

  ![魔法书位置](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/2-spellbook.jpg)
</details>


## 详细功能介绍

### 封面&目录：

打开魔法书后，会进入封面&目录标签页，该标签页由【使用说明】，【搜索言灵】，【当前跨存档言灵集】，【当前本存档言灵集】，【新建空白言灵集】，【加载言灵集】六部分组成。其中，【使用说明】即为此文档本身，可点击标题进行查看/折叠。

<details>
  <summary>点击查看图片 3.封面</summary>

  ![封面](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/3-cover.jpg)
</details>

【搜索言灵】会展示在所有本存档（链接一）和跨存档（链接二）言灵集中的搜索结果，其中本存档的搜索结果可以选择【点击查看】或【点击编辑】跳转到对应言灵集进行查看/编辑，而跨存档的搜索结果只能跳转到对应言灵集进行查看。

<details>
  <summary>点击查看图片 4.从封面搜索</summary>

  ![从封面搜索](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/4-search.jpg)
</details>

在【当前跨存档言灵集】和【当前本存档言灵集】中，点击言灵集名称即可跳转到对应言灵集。

<details>
  <summary>点击查看图片 5.言灵目录</summary>

  ![言灵目录](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/5-contents.jpg)
</details>

【新建空白言灵集】，【加载言灵集】都是创建新言灵集的方法，【加载言灵集】的数据来源为**在某一言灵集下导出的文件/复制的文本框内容**，如果你能确定文件/文本框内容的含义，也可以直接在其中进行编辑。

<details>
  <summary>点击查看补充 1.文件/文本框内容的具体含义</summary>
  <br><br>
  言灵集的基本格式如下
  ```json
  {
    "name": "侧边栏言灵", 
    "uuid": "default",
    "content": []
  }
  ```
  其中，name表示言灵集名称，uuid表示言灵集的唯一标识符，**模组内使用uuid来判断本存档和跨存档言灵集是否具有对应关系**, content 则为言灵列表里的具体内容（侧边栏言灵集的content直接就是$cccheat)。

  "default"是侧边栏言灵集专属的uuid，而其他言灵集的uuid则是随机生成的。

</details>

如果待加载的言灵集已在当前存档中存在，您可以在确认弹窗中选择【覆盖】或【新增】。覆盖侧边栏言灵（[链接三]）将同时更新游戏内左侧边栏的言灵（需在游戏内进行段落跳转/点击任意选项后生效）。

<details>
  <summary>点击查看图片 6.确认弹窗</summary>

  ![确认弹窗](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/6-confirm.jpg)
</details>

### 本存档言灵集：
在封面（[链接四]）中使用【新建空白言灵集】或【加载言灵集】即可创建一份本存档言灵集，本存档言灵集由【搜索言灵】，【编辑言灵集】，【跨存档保存言灵集】，【导出言灵集】，【添加到侧边栏（联动功能）】，【言灵列表】六个部分组成，点击言灵名称下方的链接可直接跳转到言灵列表查看/编辑当前言灵集下的言灵。

<details>
  <summary>点击查看图片 7.本存档言灵集</summary>

  ![本存档言灵集](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/7-normal.jpg)
</details>


在本存档言灵集下【搜索言灵】会展示**当前言灵集**下的搜索结果，同样可以选择【点击查看】或【点击编辑】跳转到对应言灵集进行查看/编辑。

在【编辑言灵集】中，可以删除或重命名当前言灵集，这些操作不会影响与当前言灵集对应[链接五]的公共言灵集。

在【跨存档保存言灵集】中，可以选择【直接保存】保存一份与当前言灵集对应的公共言灵集，也可以选择创建一份全新的公共言灵集，**这些操作无法通过回档撤回**。

<details>
  <summary>点击查看补充 2.跨存档言灵集的具体原理</summary>
  &nbsp;&nbsp;
  跨存档言灵集的存储位置为**浏览器的indexDB**，游戏存档和手动加载的模组列表也存储在这一位置，因此，卸载并重新安装游戏本体可能会导致跨存档言灵集丢失。

  跨存档言灵集通过uuid和本存档言灵集形成一一对应的关系，也就是说，在indexDB里的数据与其对应的本存档数据（V.spellBook）会具有同样的uuid。
</details>

使用【导出言灵集】可导出当前言灵集的数据，导出后的数据可在封面中进行加载，注意目前安卓端只能选择【从文本框复制】。

使用【添加到侧边栏（联动功能）】，可将当前言灵集中的内容加入侧边栏/从侧边栏移除，此项功能为联动功能，在使用前需要加入任意侧边栏模组（[链接六]），注意侧边栏需要在游戏内进行段落跳转（点击任意选项）后才会被更新。

【言灵列表】展示了当前言灵集的具体内容，可以在浏览/执行模式和编辑模式之间进行切换，操作方式如下图所示，其中【添加新言灵】在点击后可选择【添加到开头】或者【添加到末尾】，【删除所有选中的言灵】需要先选中言灵再进行删除。

<details>
  <summary>点击查看图片 8.编辑言灵集</summary>

  ![编辑言灵集](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/8-edit.jpg)
</details>

### 侧边栏言灵集：
魔法书中自带一份侧边栏言灵，这是**与当前侧边栏言灵保持同步的言灵集**，该言灵集不可删除/改名，在言灵集中编辑言灵也会同时修改侧边栏言灵（[链接七]），注意侧边栏需要在游戏内进行段落跳转（点击任意选项）后才会被更新。

侧边栏言灵集由【搜索言灵】，【跨存档保存言灵集】，【导出言灵集】，【言灵列表】四个部分组成，其功能与其他本存档言灵集基本一致，注意【跨存档保存言灵集】后，生成的公共言灵集不会与侧边栏言灵保持同步。

<details>
  <summary>点击查看图片 9.侧边栏言灵集</summary>

  ![侧边栏言灵集](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/9-default.jpg)
</details>

### 公共言灵集：
在本地言灵集中点击【跨存档保存言灵集】，即可生成一份公共（跨存档）言灵集，公共言灵集由【搜索言灵】，【编辑言灵集】，【导出言灵集】，【添加到侧边栏（联动功能）】，【言灵列表（仅查看）】五个部分组成。

<details>
  <summary>点击查看图片 10.公共言灵集</summary>

  ![公共言灵集](https://github.com/ZeroRing233/DOL-Custom-Spellbook-Mod/blob/master/assets/10-common.jpg)
</details>

除了搜索结果和言灵列表无法编辑以外，公共言灵集与本存档言灵集的功能基本一致。

如果需要编辑公共言灵集，可在在【编辑言灵集】中点击【复制一份到当前存档】，然后跨存档保存复制后的言灵集，跨存档保存时已经存在的公共言灵集会被更新。

### 言灵集对应关系说明：

在本存档言灵集中的【跨存档保存言灵集】下，点击【直接保存】，可生成一份对应的跨存档言灵集，已经存在的跨存档言灵集会被覆盖。

在跨存档言灵集中点击【复制一份到当前存档】，可生成一份对应的本存档言灵集，已经存在的本存档言灵集会被覆盖。

一份跨存档言灵集只会对应一份本存档言灵集，一份本存档言灵集也只会对应一份跨存档言灵集。

修改本存档言灵集，但不手动保存的情况下，对应跨存档言灵集不会改变。同样，删除跨存档言灵集也不会导致本存档言灵集被删除。

回档**无法**撤回对跨存档言灵集的修改，卸载重装游戏本体可能会导致跨存档言灵集被清空。


## 侧边栏模组推荐

## 打包方式与仓库代码说明

## 致谢